I"€&<p>Horizon View certs giving you a headache? Follow this post to take away the complication and get those servers green! This post will cover installing certs for all versions of VMware View (Horizon).<br /><br />Disclaimer: This post is based off <a href="http://kb.vmware.com/kb/2068666" target="_blank">KB 2068666</a><br />&lt;blockquote&gt;<strong>Generate the Certificate Request</strong>&lt;/blockquote&gt;<br />We‚Äôll be using the Microsoft Management Console (MMC) Certificates Snap-in.<br />&lt;ol&gt;<br />&lt;li&gt;From your Connection Server or some other Windows Server click <strong>Start</strong> &gt; <strong>Run</strong> &gt; <strong>MMC</strong>&lt;/li&gt;<br />&lt;li&gt;Click <strong>File</strong> &gt; <strong><strong>Add/Remove Snap-in‚Ä¶<br /><img alt="add-snap-in" class="alignnone size-medium wp-image-421" height="209" src="/assets/images/wordpress/2015/08/add-snap-in.png" /></strong></strong>&lt;/li&gt;<br />&lt;li&gt;Highlight <strong>Certificates</strong> and click <strong>Add &gt;<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/add-snap-in.png"><img alt="add-snap-in" class="alignnone size-medium wp-image-421" height="209" src="/assets/images/wordpress/2015/08/add-snap-in.png" /></a></strong>&lt;/li&gt;<br />&lt;li&gt;Choose ¬†<strong>Computer account</strong>¬†and click <strong>Next</strong>&lt;/li&gt;<br />&lt;li&gt;Choose¬†<strong>Local Computer</strong> &gt; <strong><strong>Finish<br /><img alt="snap-in2" class="alignnone size-medium wp-image-430" height="208" src="/assets/images/wordpress/2015/08/snap-in2.png" /></strong></strong>&lt;/li&gt;<br />&lt;li&gt;Ensure you see <strong>Certificates (Local Computer)</strong> under <strong>Selected snap-ins</strong> and click <strong>OK</strong>&lt;/li&gt;<br />&lt;li&gt;Expand <strong>Certificates (Local Computer)</strong> and right click <strong>Personal</strong> &gt; <strong>All Tasks</strong> &gt; <strong>Advanced Operations</strong> &gt; <strong>Create Custom Request<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/create-custom-request.png"><img alt="create-custom-request" class="alignnone size-medium wp-image-429" height="174" src="/assets/images/wordpress/2015/08/create-custom-request.png" /></a></strong>&lt;/li&gt;<br />&lt;li&gt;Per the splash screen, verify the computer is connected to the network and you have credentials that can be used to verify your right to obtain the certificate and click <strong>Next</strong>&lt;/li&gt;<br />&lt;li&gt;Under <strong>Custom Request</strong>, highlight <strong>Proceed without enrollment policy</strong> and click <strong><strong>Next<a href="https://thatvirtualboy.files.wordpress.com/2015/08/enrollment-policy.png"><img alt="enrollment-policy" class="alignnone size-medium wp-image-428" height="211" src="/assets/images/wordpress/2015/08/enrollment-policy.png" /></a></strong></strong>&lt;/li&gt;<br />&lt;li&gt;Select <strong>No Template Legacy key</strong> from the drop down and ensure <strong>PKCS #10</strong> is selected. Click <strong><strong>Next<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/enrollment-policy2.png"><img alt="enrollment-policy2" class="alignnone size-medium wp-image-427" height="211" src="/assets/images/wordpress/2015/08/enrollment-policy2.png" /></a></strong></strong>&lt;/li&gt;<br />&lt;li&gt;Expand <strong>Details</strong> and click <strong><strong>Properties<br /><img alt="request-properties" class="alignnone size-medium wp-image-426" height="210" src="/assets/images/wordpress/2015/08/request-properties.png" /></strong></strong>&lt;/li&gt;<br />&lt;li&gt;On the <strong>General</strong> tab,¬†type <strong>vdm¬†</strong>for the Friendly name<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/vdm.png"><img alt="vdm" class="alignnone size-medium wp-image-425" height="297" src="/assets/images/wordpress/2015/08/vdm.png" /></a>&lt;/li&gt;<br />&lt;li&gt;Click the <strong>Subject</strong> tab and enter the below values&lt;/li&gt;&lt;/ol&gt;<br />&lt;table border="‚Äù1‚Ä≥" cellpadding="‚Äù0‚Ä≥" cellspacing="‚Äù0‚Ä≥" style="width: ‚Äù390‚Ä≥px;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;Common Name&lt;/td&gt;&lt;td&gt;Value = FQDN of View Server&lt;/td&gt;&lt;td&gt;Click on Add Button&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Country&lt;/td&gt;&lt;td&gt;Value = (2 Letter Country Code, e.g., US)&lt;/td&gt;&lt;td&gt;Click on Add Button&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Locality&lt;/td&gt;&lt;td&gt;Value = (Your City Location)&lt;/td&gt;&lt;td&gt;Click on Add Button&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Organization&lt;/td&gt;&lt;td&gt;Value = (Your Company)&lt;/td&gt;&lt;td&gt;Click on Add Button&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Organization Unit&lt;/td&gt;&lt;td&gt;Value = (Department, e.g., IT)&lt;/td&gt;&lt;td&gt;Click on Add Button&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;State&lt;/td&gt;&lt;td&gt;Value =¬†(2 Letter State Code, e.g, CA)&lt;/td&gt;&lt;td&gt;Click on Add Button&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;<br />&lt;div style="padding-left: 30px;"&gt;<a href="https://thatvirtualboy.files.wordpress.com/2015/08/cert-properties.png"><img alt="cert-properties" class="alignnone size-medium wp-image-424" height="296" src="/assets/images/wordpress/2015/08/cert-properties.png" /></a>&lt;/div&gt;<br /><br />&lt;ol&gt;<br />&lt;li&gt;Click the <strong>Private Key</strong> tab &gt; Click on <strong>Key Options</strong> Details &gt; Select <strong>Keysize 2048</strong>&lt;/li&gt;<br />&lt;li&gt;Check the box for <strong>Make private key exportable¬†</strong>and click <strong>Ok</strong> &gt; <strong>Next<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/exportable.png"><img alt="exportable" class="alignnone size-medium wp-image-423" height="296" src="/assets/images/wordpress/2015/08/exportable.png" /></a></strong>&lt;/li&gt;<br />&lt;li&gt;Save the file as a .<strong>req<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/certreq.png"><img alt="certreq" class="alignnone size-medium wp-image-422" height="211" src="/assets/images/wordpress/2015/08/certreq.png" /></a></strong>&lt;/li&gt;<br />&lt;li&gt;Provide¬†this certreq.req file to your Certificate Authority per their requirements.&lt;/li&gt;&lt;/ol&gt;<br />&lt;blockquote&gt;<strong>Installing the Certificate</strong>&lt;/blockquote&gt;<br />Once the 3rd Party CA has provided you the certificate, download the necessary files (in most cases this would be the Tomcat/P7B/bundle provided by the CA). If they provide host, intermediate, and root certs, download all 3 files. Now we‚Äôll launch MMC on the Connection Server to install the cert.<br />&lt;ol&gt;<br />&lt;li&gt;Assuming the MMC console is still open and the cert snap-in is enabled, expand<strong> Certificates (Local Computer)</strong> &gt; <strong>Personal</strong> &gt; <strong>Certificates</strong>&lt;/li&gt;<br />&lt;li&gt;Right click and choose <strong>All Tasks</strong> &gt; <strong>Import<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/import.png"><img alt="Import" class="alignnone size-medium wp-image-434" height="140" src="/assets/images/wordpress/2015/08/import.png" /></a></strong>&lt;/li&gt;<br />&lt;li&gt;Select the cert bundle you downloaded<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/picture1.png"><img alt="Picture1" class="alignnone size-medium wp-image-435" height="223" src="/assets/images/wordpress/2015/08/picture1.png" /></a>NOTE: Make sure that whenever you‚Äôre prompted you choose:<br />&lt;ul&gt;<br />&lt;li&gt;Yes to Mark the Private Key Exportable&lt;/li&gt;<br />&lt;li&gt;Yes to all extended properties&lt;/li&gt;<br />&lt;li&gt;Yes to all certificates in the certification path&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;<br />&lt;li&gt;Choose¬†<strong>Automatically select the certificate store based on the type of certificate</strong> and click <strong>Next<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/picture3.png"><img alt="Picture3" class="alignnone size-medium wp-image-438" height="268" src="/assets/images/wordpress/2015/08/picture3.png" /></a></strong>&lt;/li&gt;<br />&lt;li&gt;Finish the Import wizard.&lt;/li&gt;&lt;/ol&gt;<br />&lt;div style="padding-left: 30px;"&gt;NOTE: If importing a PFX file, you will be prompted for the private key password. Check both boxes to mark as exportable and include all extended properties<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/picture2.png"><img alt="Picture2" class="alignnone size-medium wp-image-436" height="272" src="/assets/images/wordpress/2015/08/picture2.png" /></a>&lt;/div&gt;<br /><br />&lt;blockquote&gt;<strong>Important: Completing the certificate installation</strong>&lt;/blockquote&gt;<br />If you‚Äôre on <strong>View 5.1</strong> or later, you‚Äôre done! All you need to do is restart the View Connection Server Service for it to pick up the new certificate. After the service starts, wait up to 5 minutes before the View Admin page reflects the Green status.<br /><br />If you‚Äôre on <strong>View 5.0.x</strong> or earlier, you must now export the cert as a <strong>PFX¬†</strong>from the MMC console, place into the local <strong>SSL</strong> directory, and update your <strong>locked.properties</strong> file with the cert‚Äôs path.<br />&lt;ol&gt;<br />&lt;li&gt;Copy the PFX you exported to the SSL Gateway directory on the Connection Server (usually <em>install_directory\VMware\VMware View\Server\sslgateway\conf</em>)&lt;/li&gt;<br />&lt;li&gt;Edit <strong>locked.properties¬†</strong>in the same directory to contain the PFX file name and password you set during export (if you don‚Äôt have a locked.properties file, you‚Äôll need to create it)<br /><em>keyfile=key.pfx</em><br /><em>keypass=secret</em>&lt;/li&gt;<br />&lt;li&gt;Restart the Connection Server service&lt;/li&gt;&lt;/ol&gt;<br />If this post helped you get your cert installed, let me know in the comments! Good luck!</p>
:ET