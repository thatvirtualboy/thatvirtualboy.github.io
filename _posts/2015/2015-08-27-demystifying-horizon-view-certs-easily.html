---
layout: post
title: Demystifying Horizon View Certs - Easily install a signed certificate
date: '2015-08-27T05:18:00.000-07:00'
author: thatvirtualboy
excerpt: "Horizon View certs giving you a headache? Follow this post to take away the complication and get those servers green! This post will cover installing certs for all versions of VMware View (Horizon)."
tags:
- vmware
- certs
- view
- horizon
- certificates
modified_time: '2017-08-05T12:58:13.786-07:00'
blogger_id: tag:blogger.com,1999:blog-733606464149134140.post-6006573074233689646
blogger_orig_url: https://www.thatvirtualboy.com/2015/08/demystifying-horizon-view-certs-easily.html
redirect_from: /2015/08/demystifying-horizon-view-certs-easily.html
---

Horizon View certs giving you a headache? Follow this post to take away the complication and get those servers green! This post will cover installing certs for all versions of VMware View (Horizon).<br /><br />Disclaimer: This post is based off <a href="http://kb.vmware.com/kb/2068666" target="_blank">KB 2068666</a><br /><blockquote><strong>Generate the Certificate Request</strong></blockquote><br />We'll be using the Microsoft Management Console (MMC) Certificates Snap-in.<br /><ol><br /><li>From your Connection Server or some other Windows Server click <strong>Start</strong> &gt; <strong>Run</strong> &gt; <strong>MMC</strong></li><br /><li>Click <strong>File</strong> &gt; <strong><strong>Add/Remove Snap-in...<br /><img alt="add-snap-in" class="alignnone size-medium wp-image-421" height="209" src="https://thatvirtualboy.files.wordpress.com/2015/08/add-snap-in.png?w=300" width="300" /></strong></strong></li><br /><li>Highlight <strong>Certificates</strong> and click <strong>Add &gt;<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/add-snap-in.png"><img alt="add-snap-in" class="alignnone size-medium wp-image-421" height="209" src="https://thatvirtualboy.files.wordpress.com/2015/08/add-snap-in.png?w=300" width="300" /></a></strong></li><br /><li>Choose &nbsp;<strong>Computer account</strong>&nbsp;and click <strong>Next</strong></li><br /><li>Choose&nbsp;<strong>Local Computer</strong> &gt; <strong><strong>Finish<br /><img alt="snap-in2" class="alignnone size-medium wp-image-430" height="208" src="https://thatvirtualboy.files.wordpress.com/2015/08/snap-in2.png?w=300" width="300" /></strong></strong></li><br /><li>Ensure you see <strong>Certificates (Local Computer)</strong> under <strong>Selected snap-ins</strong> and click <strong>OK</strong></li><br /><li>Expand <strong>Certificates (Local Computer)</strong> and right click <strong>Personal</strong> &gt; <strong>All Tasks</strong> &gt; <strong>Advanced Operations</strong> &gt; <strong>Create Custom Request<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/create-custom-request.png"><img alt="create-custom-request" class="alignnone size-medium wp-image-429" height="174" src="https://thatvirtualboy.files.wordpress.com/2015/08/create-custom-request.png?w=300" width="300" /></a></strong></li><br /><li>Per the splash screen, verify the computer is connected to the network and you have credentials that can be used to verify your right to obtain the certificate and click <strong>Next</strong></li><br /><li>Under <strong>Custom Request</strong>, highlight <strong>Proceed without enrollment policy</strong> and click <strong><strong>Next<a href="https://thatvirtualboy.files.wordpress.com/2015/08/enrollment-policy.png"><img alt="enrollment-policy" class="alignnone size-medium wp-image-428" height="211" src="https://thatvirtualboy.files.wordpress.com/2015/08/enrollment-policy.png?w=300" width="300" /></a></strong></strong></li><br /><li>Select <strong>No Template Legacy key</strong> from the drop down and ensure <strong>PKCS #10</strong> is selected. Click <strong><strong>Next<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/enrollment-policy2.png"><img alt="enrollment-policy2" class="alignnone size-medium wp-image-427" height="211" src="https://thatvirtualboy.files.wordpress.com/2015/08/enrollment-policy2.png?w=300" width="300" /></a></strong></strong></li><br /><li>Expand <strong>Details</strong> and click <strong><strong>Properties<br /><img alt="request-properties" class="alignnone size-medium wp-image-426" height="210" src="https://thatvirtualboy.files.wordpress.com/2015/08/request-properties.png?w=300" width="300" /></strong></strong></li><br /><li>On the <strong>General</strong> tab,&nbsp;type <strong>vdm&nbsp;</strong>for the Friendly name<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/vdm.png"><img alt="vdm" class="alignnone size-medium wp-image-425" height="297" src="https://thatvirtualboy.files.wordpress.com/2015/08/vdm.png?w=300" width="300" /></a></li><br /><li>Click the <strong>Subject</strong> tab and enter the below values</li></ol><br /><table border="”1″" cellpadding="”0″" cellspacing="”0″" style="width: ”390″px;"><tbody><tr><td>Common Name</td><td>Value = FQDN of View Server</td><td>Click on Add Button</td></tr><tr><td>Country</td><td>Value = (2 Letter Country Code, e.g., US)</td><td>Click on Add Button</td></tr><tr><td>Locality</td><td>Value = (Your City Location)</td><td>Click on Add Button</td></tr><tr><td>Organization</td><td>Value = (Your Company)</td><td>Click on Add Button</td></tr><tr><td>Organization Unit</td><td>Value = (Department, e.g., IT)</td><td>Click on Add Button</td></tr><tr><td>State</td><td>Value =&nbsp;(2 Letter State Code, e.g, CA)</td><td>Click on Add Button</td></tr></tbody></table><br /><div style="padding-left: 30px;"><a href="https://thatvirtualboy.files.wordpress.com/2015/08/cert-properties.png"><img alt="cert-properties" class="alignnone size-medium wp-image-424" height="296" src="https://thatvirtualboy.files.wordpress.com/2015/08/cert-properties.png?w=300" width="300" /></a></div><br /><br /><ol><br /><li>Click the <strong>Private Key</strong> tab &gt; Click on <strong>Key Options</strong> Details &gt; Select <strong>Keysize 2048</strong></li><br /><li>Check the box for <strong>Make private key exportable&nbsp;</strong>and click <strong>Ok</strong> &gt; <strong>Next<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/exportable.png"><img alt="exportable" class="alignnone size-medium wp-image-423" height="296" src="https://thatvirtualboy.files.wordpress.com/2015/08/exportable.png?w=300" width="300" /></a></strong></li><br /><li>Save the file as a .<strong>req<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/certreq.png"><img alt="certreq" class="alignnone size-medium wp-image-422" height="211" src="https://thatvirtualboy.files.wordpress.com/2015/08/certreq.png?w=300" width="300" /></a></strong></li><br /><li>Provide&nbsp;this certreq.req file to your Certificate Authority per their requirements.</li></ol><br /><blockquote><strong>Installing the Certificate</strong></blockquote><br />Once the 3rd Party CA has provided you the certificate, download the necessary files (in most cases this would be the Tomcat/P7B/bundle provided by the CA). If they provide host, intermediate, and root certs, download all 3 files. Now we'll launch MMC on the Connection Server to install the cert.<br /><ol><br /><li>Assuming the MMC console is still open and the cert snap-in is enabled, expand<strong> Certificates (Local Computer)</strong> &gt; <strong>Personal</strong> &gt; <strong>Certificates</strong></li><br /><li>Right click and choose <strong>All Tasks</strong> &gt; <strong>Import<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/import.png"><img alt="Import" class="alignnone size-medium wp-image-434" height="140" src="https://thatvirtualboy.files.wordpress.com/2015/08/import.png?w=300" width="300" /></a></strong></li><br /><li>Select the cert bundle you downloaded<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/picture1.png"><img alt="Picture1" class="alignnone size-medium wp-image-435" height="223" src="https://thatvirtualboy.files.wordpress.com/2015/08/picture1.png?w=300" width="300" /></a>NOTE: Make sure that whenever you're prompted you choose:<br /><ul><br /><li>Yes to Mark the Private Key Exportable</li><br /><li>Yes to all extended properties</li><br /><li>Yes to all certificates in the certification path</li></ul></li><br /><li>Choose&nbsp;<strong>Automatically select the certificate store based on the type of certificate</strong> and click <strong>Next<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/picture3.png"><img alt="Picture3" class="alignnone size-medium wp-image-438" height="268" src="https://thatvirtualboy.files.wordpress.com/2015/08/picture3.png?w=300" width="300" /></a></strong></li><br /><li>Finish the Import wizard.</li></ol><br /><div style="padding-left: 30px;">NOTE: If importing a PFX file, you will be prompted for the private key password. Check both boxes to mark as exportable and include all extended properties<br /><a href="https://thatvirtualboy.files.wordpress.com/2015/08/picture2.png"><img alt="Picture2" class="alignnone size-medium wp-image-436" height="272" src="https://thatvirtualboy.files.wordpress.com/2015/08/picture2.png?w=300" width="300" /></a></div><br /><br /><blockquote><strong>Important: Completing the certificate installation</strong></blockquote><br />If you're on <strong>View 5.1</strong> or later, you're done! All you need to do is restart the View Connection Server Service for it to pick up the new certificate. After the service starts, wait up to 5 minutes before the View Admin page reflects the Green status.<br /><br />If you're on <strong>View 5.0.x</strong> or earlier, you must now export the cert as a <strong>PFX&nbsp;</strong>from the MMC console, place into the local <strong>SSL</strong> directory, and update your <strong>locked.properties</strong> file with the cert's path.<br /><ol><br /><li>Copy the PFX you exported to the SSL Gateway directory on the Connection Server (usually <em>install_directory\VMware\VMware View\Server\sslgateway\conf</em>)</li><br /><li>Edit <strong>locked.properties&nbsp;</strong>in the same directory to contain the PFX file name and password you set during export (if you don't have a locked.properties file, you'll need to create it)<br /><em>keyfile=key.pfx</em><br /><em>keypass=secret</em></li><br /><li>Restart the Connection Server service</li></ol><br />If this post helped you get your cert installed, let me know in the comments! Good luck!
